<mat-toolbar class="topbar" [style.display]="'flex'" [style.align-items]="'center'" [style.padding]="'0 16px'">
  <!-- Menu and Search Section -->
  <div class="d-flex align-items-center" [style.gap]="'8px'">
    <!-- Desktop Menu -->
    @if(showToggle) {
    <button mat-icon-button (click)="toggleCollapsed.emit()" class="d-flex justify-content-center icon-btn" 
      [style.margin-right]="'8px'">
      <mat-icon>menu_open</mat-icon>
    </button>
    }

    <!-- Mobile Menu -->
    @if(!showToggle) {
    <button mat-icon-button (click)="toggleMobileNav.emit()" class="d-flex justify-content-center" 
      [style.margin-right]="'8px'">
      <mat-icon>menu_open</mat-icon>
    </button>
    }

    <!-- Search Form -->
    <mat-form-field class="custom-search d-none-xs" *ngIf="userRole != 'Retailer'"
    [style.margin-left]="'12px'" [style.flex-grow]="'1'" [style.max-width]="'300px'">
      <mat-icon matPrefix>search</mat-icon>
      <input matInput placeholder="Search" [matAutocomplete]="auto" [formControl]="searchControl">
      <button *ngIf="searchControl.value" mat-icon-button matSuffix (click)="clearSearch()">
        <mat-icon>close</mat-icon>
      </button>
      <mat-autocomplete #auto="matAutocomplete">
        <mat-option *ngFor="let item of filteredItems" [value]="item" (click)="onOptionSelected(item)">
          <span>{{ item.oldShopId }} - {{ item.shopName }}</span>
        </mat-option>
      </mat-autocomplete>
    </mat-form-field>
  </div>

  <!-- Right Section - Notifications & Profile -->
  <div class="end-sction d-flex align-items-center" [style.margin-left]="'auto'" [style.gap]="'8px'" >
    <!-- Notification Dropdown -->
    <button mat-icon-button [matMenuTriggerFor]="notificationmenu" aria-label="Notifications" 
      class="circle-btn" [style.padding]="'4px'" *ngIf="userRole != 'Retailer'">
      <span class="material-symbols-outlined">notifications</span>
    </button>
    <mat-menu #notificationmenu="matMenu" class="topbar-dd cardWithShadow">
      <div class="d-flex align-items-center" [style.padding]="'16px 24px'" [style.border-bottom]="'1px solid #e0e0e0'">
        <h6 class="f-s-16 f-w-600 m-0 mat-subtitle-1">Notifications</h6>
        <span [style.margin-left]="'auto'">
          <span class="bg-primary text-white" [style.padding]="'4px 8px'" [style.border-radius]="'4px'" class="f-w-500 f-s-12">5 new</span>
        </span>
      </div>

      <div [style.padding]="'12px 24px'">
        <button mat-stroked-button color="primary" class="w-100">
          See all notifications
        </button>
      </div>
    </mat-menu>

    <!-- Profile Dropdown -->
    <button mat-icon-button [matMenuTriggerFor]="profilemenu" aria-label="User Profile" class="circle-btn" [style.padding]="'4px'">
      <img src="/assets/images/profile/user-1.jpg" class="rounded-circle object-cover" [style.width]="'32px'" [style.height]="'32px'" />
    </button>
    <mat-menu #profilemenu="matMenu" class="topbar-dd cardWithShadow">
      <ng-scrollbar class="position-relative" style="max-height: 300px">
        <div [style.padding]="'16px 24px'">
          <h6 class="f-s-16 f-w-600 m-0 mat-subtitle-1">User Profile</h6>

          <div class="d-flex align-items-center" [style.padding]="'16px 0'" [style.border-bottom]="'1px solid #e0e0e0'" [style.margin-top]="'12px'">
            <img src="/assets/images/profile/user-1.jpg" class="rounded-circle" [style.width]="'48px'" [style.height]="'48px'" />
            <div [style.margin-left]="'16px'">
              <h6 class="f-s-14 f-w-600 m-0 mat-subtitle-1">{{ loggedInUser.userName }}</h6>
              <span class="f-s-14 d-block" [style.margin-bottom]="'4px'">{{ loggedInUser.userRole.roleName }}</span>
              <span class="d-flex align-items-center" [style.font-size]="'12px'">
                <mat-icon [style.font-size]="'16px'" [style.width]="'16px'" [style.height]="'16px'" [style.margin-right]="'4px'">mail</mat-icon> 
                {{ loggedInUser.email }} 
              </span>
            </div>
          </div>
        </div>

        <div [style.padding]="'12px 24px'">
          <a (click)="logout()" mat-stroked-button color="primary" class="w-100" [style.display]="'flex'" [style.align-items]="'center'" [style.justify-content]="'center'" [style.gap]="'8px'">
            <mat-icon class="f-s-18">logout</mat-icon>
            Logout
          </a>
        </div>
      </ng-scrollbar>
    </mat-menu>
  </div>
</mat-toolbar>